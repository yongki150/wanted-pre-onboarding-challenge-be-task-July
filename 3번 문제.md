클라이언트 PC에서 시작해 웹 서버, AP 서버, DB 서버 순으로 도달해옵니다.

1. 클라이언트 PC에서 웹 서버까지 입니다.

```
1-1. 웹 브라우저가 화면에서 네이버 링크를 클릭하면 웹 서버로 요청을 보냅니다.
  1-1-1. 웹 브라우저 프로세스는 커널을 시스템 콜로 호출합니다. 
  1-1-2. 커널을 통해 NIC에 네트워크 통신이 요청됩니다.
  1-1-2. 네트워크 경유로 웹 서버에 요청합니다.

1-2. 네이버의 IP 주소를 모르기 때문에, 해석을 합니다.
  1-2-1. 웹 브라우저 프로세스는 커널을 시스템 콜로 호출합니다. 
  1-2-2. 커널을 통해 OS의 호스트명, IP 주소 변환 테이블을 참조해서 존재하지 않는 경우, 외부의 DNS 서버에 요청을 보냅니다. 
  1-2-2. DNS 서버로부터 IP 주소 검색 결과가 반환됩니다.
          ※ 전 세계에 있는 DNS 서버는 Root DNS를 기준으로 트리 구조로 되어 있습니다. 
            개별 DNS 서버는 정기적으로 부모 DNS 서버에서 데이터를 받아서 최신 IP 주소 목록을 유지합니다.

1-3. 네이버의 IP 주소인 웹서버에 요청을 보냅니다.
1-4. 웹 서버의 httpd 프로세스가 요청을 접수합니다.
1-5. httpd가 받은 요청 내용을 분석해서 정적인 내용인지 동적인 내용인지를 판단합니다.
1-6-A. 정적인 정보는 디스크로부터 읽습니다.
1-6-B. 동적인 정보는 네트워크를 경유해서 다른 서버에 요청을 보냅니다.
```

2. 웹 서버에서 AP 서버까지 입니다.

```
2-1. 웹 서버에서 온 요청은 NIC를 경유해서 커널에 의해 인터럽트 처리됩니다.
2-2. 스레드가 요청을 접수합니다.
2-3-A. 동적 데이터를 가져오기 위해 연결 풀을 이용하여 DB 서버에 접속합니다. 또는 캐시 전용 서버가 있으면 그쪽에 접속합니다.
  2-3-A-1. 스레드는 커널을 시스템 콜로 호출합니다.
  2-3-A-2. 네트워크 경유로 다른 서버에 요청합니다.

2-3-B. 스레드를 담당하는 프로세스에 데이터가 캐시되 있으면 바로 데이터를 반환합니다.
```

3. AP 서버에서 DB 서버까지 입니다.

```
3-1. DB 프로세스가 요청을 접수합니다.
3-2. 캐시된 데이터를 찾기 위해 공유 메모리를 검색합니다.
3-3. 공유 메모리에 데이터가 존재하지 않으면 디스크로부터 읽습니다.
  3-3-1. DB 프로세스는 커널을 시스템 콜로 호출합니다.
  3-3-2. 커널을 통해 디스크에 요청합니다.
  3-3-3. 디스크의 데이터는 요청을 보낸 프로세스로 반환됩니다.

3-4. 한번 읽힌 데이터는 메모리에 캐시 형태로 저장되고 이후 읽기 작업에 재사용됩니다.
3-5. AP 서버로 데이터를 반환합니다.
```

4. AP 서버에서 웹 서버까지 입니다.

```
4-1. 다른 서버에서 돌아온 데이터는 NIC 경유로 스레드에 반환됩니다.
4-2. 다른 서버에서 돌아온 데이터, 프로세스의 캐시 데이터 등을 이용해서 계산 처리, 집계 처리 등이 이루어지고 파일 데이터가 생성됩니다.
4-3. 웹 서버로 데이터를 반환합니다.
```

5. 웹 서버에서 클라이언트 PC까지 입니다.

```
5-1. AP 서버에서 돌아온 데이터는 NIC 경유로 웹 서버의 httpd 프로세스에 반환됩니다.
5-2. httpd 프로세스는 받은 데이터를 그대로 웹 브라우저에 반환합니다.
5-3. 화면에 출력됩니다.
```

***

> *야마자키 야스시 외 3 (2022). 그림으로 공부하는 IT 인프라 구조(개정판). 경기도 파주: 주식회사 제이펍.*
